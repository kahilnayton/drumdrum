{"ast":null,"code":"import p5 from \"p5\";\nimport 'p5/lib/addons/p5.sound';\nlet hh, clap, kick, snare, tom, soundFile;\nlet hPat, cPat, bPat;\nlet hPhrase, bPhrase, sPhrase, cPhrase;\nlet drums;\nlet bpmCTRL;\nlet beatLength;\nlet cellWidth;\nlet cnv;\nlet sPat;\nlet cursorPos;\nlet button;\nlet rSlider, gSlider, bSlider;\nlet followBeat;\nlet reverb, sound;\nlet r, g, b;\nlet color;\nlet props;\nexport default function (p) {\n  p.setOnReady = function (cb) {};\n\n  p.pushProps = function (_props) {};\n\n  let onReady = () => {};\n\n  let props = {};\n\n  p.preload = () => {\n    p.soundFormats('mp3');\n    hh = p.loadSound('samples/Hat5.mp3', () => {});\n    clap = p.loadSound('samples/Clap3.mp3', () => {});\n    kick = p.loadSound('samples/Kick2.mp3', () => {});\n    snare = p.loadSound('samples/Snare1.mp3', () => {});\n  };\n\n  p.setup = function () {\n    let cnv = p.createCanvas(p.windowWidth, 200);\n    cnv.mousePressed(canvasPressed);\n    beatLength = 16;\n    cellWidth = p.width / beatLength;\n    cursorPos = 0;\n    p.preload(drums);\n    hPat = [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0];\n    cPat = [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0];\n    bPat = [1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0];\n    sPat = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0];\n    followBeat = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16];\n    hPhrase = new p5.Phrase('hh', time => {\n      hh.play(time);\n    }, hPat);\n    cPhrase = new p5.Phrase('clap', time => {\n      clap.play(time);\n    }, cPat);\n    bPhrase = new p5.Phrase('kick', time => {\n      kick.play(time);\n    }, bPat);\n    sPhrase = new p5.Phrase('snare', time => {\n      snare.play(time);\n    }, sPat);\n    drums = new p5.Part();\n    drums.addPhrase(hPhrase);\n    drums.addPhrase(cPhrase);\n    drums.addPhrase(bPhrase);\n    drums.addPhrase(sPhrase);\n    drums.addPhrase('seq', p.sequence, followBeat);\n    drums.onStep(() => {\n      console.log(drums.partStep);\n    });\n    drums.setBPM('70');\n    drawMatrix();\n  };\n\n  p.draw = function () {};\n\n  p.keyPressed = e => {\n    e.preventDefault();\n\n    if (p.key === \" \") {\n      if (hh.isLoaded() && clap.isLoaded() && kick.isLoaded() && snare.isLoaded()) {\n        if (!drums.isPlaying) {\n          drums.loop();\n        } else {\n          drums.stop();\n          console.log('ooops no drums');\n        }\n      }\n    }\n  };\n\n  function canvasPressed() {\n    let rowClicked = p.floor(4 * p.mouseY / p.height);\n    let indexClicked = p.floor(16 * p.mouseX / p.width);\n\n    if (rowClicked === 0) {\n      hPat[indexClicked] = +!hPat[indexClicked];\n    } else if (rowClicked === 1) {\n      cPat[indexClicked] = +!cPat[indexClicked];\n    } else if (rowClicked === 2) {\n      bPat[indexClicked] = +!bPat[indexClicked];\n    } else if (rowClicked === 3) {\n      sPat[indexClicked] = +!sPat[indexClicked];\n    }\n\n    drawMatrix();\n  }\n\n  function drawMatrix() {\n    p.background(300, 200);\n    p.stroke('black');\n    p.strokeWeight(2);\n    p.fill('black');\n\n    for (let i = 0; i < beatLength; i++) {\n      p.line(i * p.width / beatLength, 0, i * p.width / beatLength, p.height);\n    }\n\n    for (let i = 0; i < 5; i++) {\n      p.line(0, i * p.height / 4, p.width, i * p.height / 4);\n    }\n\n    p.noStroke();\n\n    for (let i = 0; i < beatLength; i++) {\n      if (hPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height / 8, 25);\n      }\n\n      if (cPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height * 3 / 8, 25);\n      }\n\n      if (bPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height * 5 / 8, 25);\n      }\n\n      if (sPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height * 7 / 8, 25);\n      }\n    }\n  }\n\n  p.sequence = (time, beatIndex) => {\n    setTimeout(() => {\n      drawMatrix();\n      drawPlayhead(beatIndex);\n    }, time * 1000);\n  };\n\n  function drawPlayhead(beatIndex) {\n    p.stroke('red');\n    p.fill(255, 0, 0, 30);\n    p.rect((beatIndex - 1) * cellWidth, 0, cellWidth, p.height);\n  }\n}","map":{"version":3,"sources":["/Users/Kahil/Desktop/sei/drumdrum/client/src/components/P5Wrapper/sketch.js"],"names":["p5","hh","clap","kick","snare","tom","soundFile","hPat","cPat","bPat","hPhrase","bPhrase","sPhrase","cPhrase","drums","bpmCTRL","beatLength","cellWidth","cnv","sPat","cursorPos","button","rSlider","gSlider","bSlider","followBeat","reverb","sound","r","g","b","color","props","p","setOnReady","cb","pushProps","_props","onReady","preload","soundFormats","loadSound","setup","createCanvas","windowWidth","mousePressed","canvasPressed","width","Phrase","time","play","Part","addPhrase","sequence","onStep","console","log","partStep","setBPM","drawMatrix","draw","keyPressed","e","preventDefault","key","isLoaded","isPlaying","loop","stop","rowClicked","floor","mouseY","height","indexClicked","mouseX","background","stroke","strokeWeight","fill","i","line","noStroke","ellipse","beatIndex","setTimeout","drawPlayhead","rect"],"mappings":"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","sourcesContent":["\nimport p5 from \"p5\";\nimport 'p5/lib/addons/p5.sound';\n\n\n\n\nlet hh, clap, kick, snare, tom, soundFile\nlet hPat, cPat, bPat;\nlet hPhrase, bPhrase, sPhrase, cPhrase;\nlet drums;\nlet bpmCTRL;\nlet beatLength;\nlet cellWidth\nlet cnv\nlet sPat\nlet cursorPos\nlet button\nlet rSlider, gSlider, bSlider;\nlet followBeat\nlet reverb, sound\nlet r, g, b\nlet color;\nlet props;\n\n\nexport default function (p) {\n  p.setOnReady = function (cb) {\n \n  }\n\n  p.pushProps = function (_props) {\n  }\n\n  let onReady = () => { };\n  let props = {};\n\n  p.preload = () => {\n    p.soundFormats('mp3');\n\n    hh = p.loadSound('samples/Hat5.mp3', () => { })\n    clap = p.loadSound('samples/Clap3.mp3', () => { })\n    kick = p.loadSound('samples/Kick2.mp3', () => { })\n    snare = p.loadSound('samples/Snare1.mp3', () => { })\n\n  }\n\n  p.setup = function () {\n    let cnv = p.createCanvas(p.windowWidth, 200);\n    cnv.mousePressed(canvasPressed)\n    beatLength = 16\n    cellWidth = p.width / beatLength\n    cursorPos = 0\n\n    p.preload(drums)\n\n\n    hPat = [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]\n    cPat = [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]\n    bPat = [1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0]\n    sPat = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]\n    followBeat = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n\n\n    hPhrase = new p5.Phrase('hh', (time) => { hh.play(time) }, hPat);\n    cPhrase = new p5.Phrase('clap', (time) => { clap.play(time) }, cPat);\n    bPhrase = new p5.Phrase('kick', (time) => { kick.play(time) }, bPat);\n    sPhrase = new p5.Phrase('snare', (time) => { snare.play(time) }, sPat);\n\n    drums = new p5.Part();\n\n    drums.addPhrase(hPhrase)\n    drums.addPhrase(cPhrase)\n    drums.addPhrase(bPhrase)\n    drums.addPhrase(sPhrase)\n\n    drums.addPhrase('seq', p.sequence, followBeat)\n    drums.onStep(() => { console.log(drums.partStep) })\n\n    \n    drums.setBPM('70')\n    \n    drawMatrix()\n    \n  }\n  \n  \n  p.draw = function () {\n    \n \n\n  }\n\n\n\n  p.keyPressed = (e) => {\n    e.preventDefault()\n    if (p.key === \" \") {\n      if (hh.isLoaded() && clap.isLoaded() && kick.isLoaded() && snare.isLoaded()) {\n        if (!drums.isPlaying) {\n          drums.loop()\n        } else {\n          drums.stop()\n          console.log('ooops no drums')\n        }\n      }\n    }\n  }\n\n\n  function canvasPressed() {\n    let rowClicked = p.floor(4 * p.mouseY / p.height)\n    let indexClicked = p.floor(16 * p.mouseX / p.width)\n    if (rowClicked === 0) {\n      hPat[indexClicked] = +!hPat[indexClicked]\n    } else if (rowClicked === 1) {\n      cPat[indexClicked] = +!cPat[indexClicked]\n    } else if (rowClicked === 2) {\n      bPat[indexClicked] = +!bPat[indexClicked]\n    } else if (rowClicked === 3) {\n      sPat[indexClicked] = +!sPat[indexClicked]\n    }\n    drawMatrix()\n  }\n\n  function drawMatrix() {\n    p.background(300, 200)\n    p.stroke('black')\n    p.strokeWeight(2)\n    p.fill('black')\n  \n\n    for (let i = 0; i < beatLength; i++) {\n      p.line(i * p.width / beatLength, 0, i * p.width / beatLength, p.height)\n    } for (let i = 0; i < 5; i++) {\n      p.line(0, i * p.height / 4, p.width, i * p.height / 4)\n    }\n    p.noStroke()\n\n    for (let i = 0; i < beatLength; i++) {\n      if (hPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height / 8, 25)\n      }\n      if (cPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height * 3 / 8, 25)\n      }\n      if (bPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height * 5 / 8, 25)\n      }\n      if (sPat[i] === 1) {\n        p.ellipse(i * cellWidth + 0.5 * cellWidth, p.height * 7 / 8, 25)\n      }\n    }\n  }\n\n  p.sequence = (time, beatIndex) => {\n    setTimeout(() => {\n      drawMatrix()\n      drawPlayhead(beatIndex)\n    }, time * 1000)\n\n  }\n\n  function drawPlayhead(beatIndex) {\n    p.stroke('red')\n    p.fill(255, 0, 0, 30)\n    p.rect((beatIndex - 1) * cellWidth, 0, cellWidth, p.height)\n  }\n\n}\n\n"]},"metadata":{},"sourceType":"module"}